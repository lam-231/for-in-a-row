<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: useGame.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: useGame.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { useState, useEffect } from 'react';
import { PLAYER_1, PLAYER_2 } from '../constants';

/**
 * Створює пусте ігрове поле заданого розміру.
 * @param {number} rows - Кількість рядків.
 * @param {number} cols - Кількість колонок.
 * @returns {Array&lt;Array&lt;string|null>>} Двовимірний масив, що представляє ігрове поле.
 */
const createBoard = (rows, cols) =>
    Array(rows).fill(null).map(() => Array(cols).fill(null));


/**
 * Кастомний хук для управління логікою гри "Чотири в ряд".
 * @param {number} rows - Кількість рядків на ігровому полі.
 * @param {number} cols - Кількість колонок на ігровому полі.
 * @returns {Object} Об'єкт зі станом гри та функціями для управління нею.
 * @property {Array&lt;Array&lt;string|null>>} board - Поточний стан ігрового поля.
 * @property {string} currentPlayer - Поточний гравець (PLAYER_1 або PLAYER_2).
 * @property {string|null} winner - Переможець ('red', 'yellow', 'draw' або null).
 * @property {boolean} isGameOver - Прапорець, що вказує на завершення гри.
 * @property {Function} makeMove - Функція для здійснення ходу в задану колонку.
 * @property {Function} resetGame - Функція для скидання стану гри.
 */
export const useGame = (rows, cols) => {
    const [board, setBoard] = useState(() => createBoard(rows, cols));
    const [currentPlayer, setCurrentPlayer] = useState(PLAYER_1);
    const [winner, setWinner] = useState(null);
    const [isGameOver, setIsGameOver] = useState(false);

    useEffect(() => {
        resetGame();
    }, [rows, cols]);



    /**
     * Перевіряє наявність переможця на полі.
     * @param {Array&lt;Array&lt;string|null>>} boardState - Поточний стан поля.
     * @param {string} player - Гравець для перевірки.
     * @returns {boolean} Повертає true, якщо гравець зібрав 4 фішки в ряд.
     */
    const checkWinner = (boardState, player) => {
        const directions = [
            [0, 1],
            [1, 0],
            [1, 1],
            [1, -1]
        ];

        const currentRows = boardState.length;
        const currentCols = boardState[0].length;

        for (let r = 0; r &lt; currentRows; r++) {
            for (let c = 0; c &lt; currentCols; c++) {
                if (boardState[r][c] !== player) continue;

                for (let [dr, dc] of directions) {
                    let count = 0;
                    for (let i = 0; i &lt; 4; i++) {
                        const nr = r + dr * i;
                        const nc = c + dc * i;

                        if (
                            nr >= 0 &amp;&amp; nr &lt; currentRows &amp;&amp;
                            nc >= 0 &amp;&amp; nc &lt; currentCols &amp;&amp;
                            boardState[nr][nc] === player
                        ) {
                            count++;
                        } else {
                            break;
                        }
                    }
                    if (count === 4) return true;
                }
            }
        }
        return false;
    };

    /**
     * Перевіряє, чи закінчилась гра внічию (немає вільних клітинок).
     * @param {Array&lt;Array&lt;string|null>>} boardState - Поточний стан поля.
     * @returns {boolean} Повертає true, якщо нічия.
     */
    const checkDraw = (boardState) => {
        return boardState.every(row => row.every(cell => cell !== null));
    };

    /**
     * Здійснює хід поточного гравця у вибрану колонку.
     * @param {number} colIndex - Індекс колонки для ходу.
     */
    const makeMove = (colIndex) => {
        if (isGameOver) return;

        const newBoard = board.map(row => [...row]);

        let rowIndex = -1;
        for (let r = board.length - 1; r >= 0; r--) {
            if (newBoard[r][colIndex] === null) {
                rowIndex = r;
                break;
            }
        }

        if (rowIndex === -1) return;

        newBoard[rowIndex][colIndex] = currentPlayer;
        setBoard(newBoard);

        if (checkWinner(newBoard, currentPlayer)) {
            setWinner(currentPlayer);
            setIsGameOver(true);
        } else if (checkDraw(newBoard)) {
            setWinner('draw');
            setIsGameOver(true);
        } else {
            setCurrentPlayer(prev => prev === PLAYER_1 ? PLAYER_2 : PLAYER_1);
        }
    };

    /**
     * Скидає гру до початкового стану.
     */
    const resetGame = () => {
        setBoard(createBoard(rows, cols));
        setCurrentPlayer(PLAYER_1);
        setWinner(null);
        setIsGameOver(false);
    };

    return { board, currentPlayer, winner, isGameOver, makeMove, resetGame };
};</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#createBoard">createBoard</a></li><li><a href="global.html#useGame">useGame</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Fri Feb 27 2026 18:43:47 GMT+0200 (за східноєвропейським стандартним часом)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
